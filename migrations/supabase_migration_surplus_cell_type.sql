-- =====================================================
-- МИГРАЦИЯ: Добавление типа ячейки "surplus" (Излишки)
-- Дата: 2026-01-20
-- Описание: Новый тип ячейки для товаров без ТТНК
-- =====================================================

-- 1. Добавляем новый тип ячейки в CHECK constraint (если есть)
-- Обычно это делается через ALTER TABLE, но зависит от структуры БД

-- 2. Создаем ячейку SURPLUS-1 для склада

INSERT INTO warehouse_cells_map (
  code,
  cell_type,
  warehouse_id
)
VALUES
  ('SURPLUS-1', 'surplus', '0c99a861-3809-4bef-9106-79a37330b13c'::uuid)
ON CONFLICT (code, warehouse_id) DO NOTHING;

-- 3. Уведомление PostgREST о изменении схемы
NOTIFY pgrst, 'reload schema';

-- =====================================================
-- ПРИМЕЧАНИЯ:
-- - surplus ячейки используются для приемки товаров без документов
-- - Проверка на дубликаты при приемке обязательна
-- - Товары в surplus можно редактировать через /app/surplus
-- =====================================================
